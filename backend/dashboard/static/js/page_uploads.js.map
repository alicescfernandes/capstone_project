{
  "version": 3,
  "sources": ["../../../src/js/page_uploads.js"],
  "sourcesContent": ["FilePond.registerPlugin(FilePondPluginFileValidateType);\n\nconst filePond = FilePond.create(document.querySelector('#filepond'), {\n    allowMultiple: true,\n    storeAsFile: true,\n    acceptedFileTypes: [\n        'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n        'application/vnd.ms-excel'\n    ],\n    fileValidateTypeDetectType: (source, type) =>\n        new Promise((resolve) => {\n            const name = source.name.toLowerCase();\n\n            if (name.endsWith('.xls')) {\n                return resolve('application/vnd.ms-excel');\n            }\n\n            if (name.endsWith('.xlsx')) {\n                return resolve('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');\n            }\n\n            resolve(type);\n        }),\n    // labelFileTypeNotAllowed: 'Apenas ficheiros Excel (.xls, .xlsx) s\u00E3o permitidos.',\n    // fileValidateTypeLabelExpectedTypes: 'Tipos permitidos: {allTypes}'\n});\n\nexport function openEditModal(button) {\n    const uuid = button.getAttribute('data-quarter-id');\n    const number = button.getAttribute('data-quarter-number');\n    const modalHeaderTitle = button.getAttribute('data-modal-title');\n\n    const form = document.getElementById('edit-quarter-form');\n    const numberInput = document.getElementById('edit-quarter-number');\n    const precisionInput = document.getElementById('edit-quarter-precision');\n\n    const modalHeader = document.getElementById('modal-title');\n\n    modalHeader.textContent = modalHeaderTitle ?? 'Edit Files'\n\n    numberInput.value = number;\n    precisionInput.value = '9';  // Default value for new quarters\n\n    if (uuid === 'new') {\n        form.action = `/quarters/new/`;\n    } else {\n        form.action = `/quarters/edit/${uuid}/`;\n        fetch(`/api/quarters?q=${number}`)\n            .then(response => response.json())\n            .then(data => {\n                if (data.float_precision) {\n                    precisionInput.value = data.float_precision;\n                }\n            })\n            .catch(error => console.error('Error fetching quarter precision:', error));\n    }\n}\n\n// Attach event listener to the document (delegation)\ndocument.addEventListener(\"click\", (e) => {\n    const target = e.target.closest('.upload-edit-link');\n    if (target) {\n        openEditModal(target);\n    }\n});\n\n\n\n// Add event listener for modal close button\ndocument.addEventListener(\"click\", (e) => {\n    if (e.target.classList.contains('upload-close-modal')) {\n        const form = document.getElementById('edit-quarter-form');\n        form.reset();\n        filePond.removeFiles();\n    }\n});"],
  "mappings": "MAAA,SAAS,eAAe,8BAA8B,EAEtD,IAAMA,EAAW,SAAS,OAAO,SAAS,cAAc,WAAW,EAAG,CAClE,cAAe,GACf,YAAa,GACb,kBAAmB,CACf,oEACA,0BACJ,EACA,2BAA4B,CAACC,EAAQC,IACjC,IAAI,QAASC,GAAY,CACrB,IAAMC,EAAOH,EAAO,KAAK,YAAY,EAErC,GAAIG,EAAK,SAAS,MAAM,EACpB,OAAOD,EAAQ,0BAA0B,EAG7C,GAAIC,EAAK,SAAS,OAAO,EACrB,OAAOD,EAAQ,mEAAmE,EAGtFA,EAAQD,CAAI,CAChB,CAAC,CAGT,CAAC,EAEM,SAASG,EAAcC,EAAQ,CAClC,IAAMC,EAAOD,EAAO,aAAa,iBAAiB,EAC5CE,EAASF,EAAO,aAAa,qBAAqB,EAClDG,EAAmBH,EAAO,aAAa,kBAAkB,EAEzDI,EAAO,SAAS,eAAe,mBAAmB,EAClDC,EAAc,SAAS,eAAe,qBAAqB,EAC3DC,EAAiB,SAAS,eAAe,wBAAwB,EAEjEC,EAAc,SAAS,eAAe,aAAa,EAEzDA,EAAY,YAAcJ,GAAA,KAAAA,EAAoB,aAE9CE,EAAY,MAAQH,EACpBI,EAAe,MAAQ,IAEnBL,IAAS,MACTG,EAAK,OAAS,kBAEdA,EAAK,OAAS,kBAAkBH,CAAI,IACpC,MAAM,mBAAmBC,CAAM,EAAE,EAC5B,KAAKM,GAAYA,EAAS,KAAK,CAAC,EAChC,KAAKC,GAAQ,CACNA,EAAK,kBACLH,EAAe,MAAQG,EAAK,gBAEpC,CAAC,EACA,MAAMC,GAAS,QAAQ,MAAM,oCAAqCA,CAAK,CAAC,EAErF,CAGA,SAAS,iBAAiB,QAAU,GAAM,CACtC,IAAMC,EAAS,EAAE,OAAO,QAAQ,mBAAmB,EAC/CA,GACAZ,EAAcY,CAAM,CAE5B,CAAC,EAKD,SAAS,iBAAiB,QAAU,GAAM,CAClC,EAAE,OAAO,UAAU,SAAS,oBAAoB,IACnC,SAAS,eAAe,mBAAmB,EACnD,MAAM,EACXjB,EAAS,YAAY,EAE7B,CAAC",
  "names": ["filePond", "source", "type", "resolve", "name", "openEditModal", "button", "uuid", "number", "modalHeaderTitle", "form", "numberInput", "precisionInput", "modalHeader", "response", "data", "error", "target"]
}
