%%________________________________________________________________________
%% LEIM | PROJETO
%% 2022 / 2013 / 2012
%% Modelo para relatório
%% v04: alteração ADEETC para DEETC; outros ajustes
%% v03: correção de gralhas
%% v02: inclui anexo sobre utilização sistema controlo de versões
%% v01: original
%% PTS / MAR.2022 / MAI.2013 / 23.MAI.2012 (construído)
%%________________________________________________________________________




%%________________________________________________________________________
\chapter{Introdução}
\label{ch:introducao}
%%________________________________________________________________________

%%\gls{xlsx}

The \gls{api} provides access to the hardware.


No contexto do ensino superior, a integração de ferramentas tecnológicas que potencializem o processo de aprendizagem é cada vez mais valorizada. Particularmente, em ambientes que simulam situações empresariais reais, como é o caso do simulador utilizado pelos alunos do ISCAL.  A análise eficiente de dados torna-se essencial para a tomada de decisões estratégicas e tem impacto na avaliação final dos alunos, no entanto, a complexidade e a falta de visuais que ajudem a perceber as informações apresentadas pela plataforma original podem representar um desafio significativo para os estudantes. A 

\subsection{Motivação}
O presente projeto surgiu da necessidade  entre os alunos do ISCAL que utilizam o simulador empresarial \textit{Marketplace Simulations – International Corporate Management} que é um simulador de negócios internacionais, onde os alunos se agrupam em empresas e simulam a criação de um negócio num mercado internacional. Embora a plataforma forneça toda a informação necessária à tomada de decisões na simulação, esses dados estão dispersos em múltiplas secções e apresentados em tabelas, sem funcionalidades de visualização gráfica ou filtragem. Esta limitação obriga os alunos a alternar entre páginas, copiar dados manualmente e criar folhas de cálculo externas, comprometendo tanto a eficiência quanto a qualidade da análise.


\subsection{Objetivos}

A aplicação proposta neste relatório pretende ajudar nesse sentido, oferecendo uma interface  funcional que permite aos utilizadores carregar ficheiros XLSX exportados da plataforma originais e tornar esses ficheiros em visualizações que podem ser consultadas e manipuladas. A aplicação permitirá aos utilizadores:
\begin{itemize}
    \item Criar uma conta na plataforma que permita persistir a informação carregada.
    \item Carregar ficheiros XLSX exportados da plataforma original;
    \item Visualizar os dados em gráficos interativos;
\end{itemize}

Do ponto de vista técnico, queremos que  projeto adote uma arquitetura fácil ed manter e que vá de encontro à utilização da plataforma, dando ênfase aos seguintes itens:
\begin{itemize}
    \item A normalização e transformação automática de dados provenientes de fontes externas;
    \item A facilidade na gestão de utilizadores e ficheiros, com o objetivo de oferecer uma experiência intuitiva para os utilizadores finais.
    \item Organizar a informação por utilizador, garantindo que o utilizador apenas consegue consultar a informação carregada.
    \item Adotar um modelo de organização semelhante à plataforma de simulação, de modo a tornar a experiência de utilização mais intuitiva e garantido que a nossa aplicação tenha fronteiras claras de utilização.
\end{itemize}

Ao longo deste relatório, serão detalhadamente apresentadas as decisões tomadas, bem como os fundamentos que orientaram o desenvolvimento da aplicação proposta.

%%________________________________________________________________________
\chapter{Trabalho Relacionado}
\label{ch:trabalhoRelacionado}
%%________________________________________________________________________

O presente projeto insere-se num contexto mais vasto de ferramentas pedagógicas e plataformas de apoio à tomada de decisão em ambientes simulados, particularmente no ensino superior com foco em gestão e estratégia empresarial. No âmbito do ISCAL, tem sido recorrente a utilização de plataformas como o \textit{Marketplace Simulations}, que permitem aos estudantes desenvolver competências práticas em ambientes virtuais de negócios, replicando o funcionamento de mercados reais. Esta necessidade de suporte digital à análise e interpretação de dados já motivou o desenvolvimento de outras ferramentas auxiliares, com destaque para um projeto também realizado em parceria com o ISCAL, focado em simulações parciais de modelos económicos simplificados.

Esse projeto, embora partilhe a mesma motivação — facilitar a análise de informação extraída de simuladores empresariais — apresentava uma abordagem distinta. Em particular, a aplicação permitia simular cenários específicos com base em inputs manuais ou em pequenos ficheiros com dados sintetizados, o que se revelou útil para exercícios de curto alcance ou com foco muito delimitado (por exemplo, simular o impacto de uma única variável nos resultados de uma empresa virtual). No entanto, não oferecia suporte direto ao processamento automático dos dados reais exportados da plataforma \textit{Marketplace Simulations}, nem dispunha de funcionalidades integradas de normalização de dados ou visualização gráfica dinâmica.

O projeto atual distingue-se, assim, tanto pelo seu alcance como pela profundidade técnica das soluções propostas. Ao contrário do sistema anterior, que se baseava em simulações parametrizadas e modelos estáticos, esta nova aplicação aposta numa abordagem orientada a dados, onde a informação real dos jogos de simulação é carregada diretamente pelo utilizador. Essa escolha trouxe consigo a necessidade de resolver questões de normalização, estruturação e tratamento de grandes volumes de folhas de cálculo, algo que não era exigido nos projetos anteriores.

Além disso, o trabalho atual introduz um modelo de organização baseado em "quarters", associando cada conjunto de dados a um ciclo temporal definido e mantendo a rastreabilidade por utilizador. A utilização de um pipeline modular de limpeza e conversão de dados, aliado à geração automática de gráficos interativos com filtros avançados, representa um avanço significativo em termos de sofisticação funcional. Também ao nível da arquitetura, a adoção de tecnologias como Django, Pandas, Plotly e WebComponents configura uma base técnica robusta, capaz de escalar e ser adaptada a novos contextos.

Este trabalho assume, portanto, como pressuposto o uso de dados reais extraídos diretamente do simulador, a necessidade de integração com um sistema de autenticação e gestão de utilizadores, e a valorização da experiência do utilizador (UX) na apresentação de dados. Em conjunto, estes elementos definem uma solução mais abrangente e alinhada com os desafios técnicos reais da análise de dados em contexto educativo, indo além das simulações reduzidas ou controladas que caracterizavam os trabalhos relacionados anteriormente desenvolvidos.


%%________________________________________________________________________
\chapter{Modelo Proposto}
\label{ch:modeloProposto}
%%________________________________________________________________________

Aqui mostra um caminho que inicia com requisitos (\cf, secção \ref{sec:requisitos}), passa pela aplicação dos fundamentos (\cf, secção \ref{sec:fundamentos}) e continua até conseguir transmitir uma visão clara e um formalismo com nível de detalhe adequado a um leitor que tenha um perfil (competência técnica) idêntico ao seu.

Recorra, sempre que possível, a exemplos ilustrativos da utilização do seu modelo. Esses exemplos devem ajudar o leitor a compreender os aspectos mais específicos do seu trabalho.

O modelo aqui proposto deve ser (tanto quanto possível) independente de tecnologias concretas (\eg, linguagens de programação ou bibliotecas). No entanto,, deve fornecer os argumentos que contribuam para justificar uma posterior escolha (adoção) de tecnologias.


(falta introduzir o modelo proposto)


%%________________________________________________________________________
\section{Requisitos}
\label{sec:requisitos}
%%________________________________________________________________________

Aqui o essencial (e se aplicável) dos requisitos funcionais, não funcionais e modelo de casos de utilização. Aqui deve também apresentar matriz para decisão sobre prioridade dos casos de utilização (se aplicável) \ldots

Deve apresentar de forma \aspas{moderada} o resultado da fase avaliação de requisitos. A informação de maior detalhe (\eg, diagramas UML demasiado detalhados) deve ser colocada em apêndice.

\subsubsection{Requisitos funcionais}
Os requisitos funcionais descrevem as funcionalidades específicas que a aplicação deve oferecer para atender às necessidades dos utilizadores. No contexto deste projeto, definem as ações que o sistema deve ser capaz de executar. No nosso projeto, identificamos os seguintes requisitos:

\begin{itemize}
    \item \textbf{Visualizações dinâmicas:} a aplicação deve conseguir mostrar gráficos com base nos dados carregados, com suporte a alteração de parâmetros em tempo real (por exemplo, mudar de \textit{quarter} ou selecionar um país específico).
    \item \textbf{Upload e processamento de ficheiros XLSX:} os utilizadores devem conseguir carregar ficheiros \textit{Excel} com múltiplas folhas; esses ficheiros são automaticamente convertidos para CSV e normalizados.
    \item \textbf{Autenticação e gestão de utilizadores:} cada utilizador tem uma conta e pode gerir os seus próprios dados. Apenas os ficheiros mais recentes serão considerados para as visualizações.
    \item \textbf{Gestão de \textit{quarters}:} os utilizadores podem criar períodos temporais (\textit{quarters}), cada um identificado por um número, que funcionam como \textit{bucket} lógicos para organizar os ficheiros carregados.
\end{itemize}


\subsubsection{Requisitos não funcionais}

Alguns requisitos não funcionais foram igualmente críticos para garantir a robustez e usabilidade do sistema (TODO):

\begin{itemize}
    \item \textbf{Normalização da informação: } A \textit{pipeline} de processamento é isolada e modular, facilitando a manutenção e futura extensão do sistema.
    \item \textbf{Normalização dos dados:} foram aplicadas rotinas automáticas para garantir coerência nos nomes de colunas, remoção de quebras de linha, e eliminação de colunas irrelevantes.
    \item \textbf{Isolamento por utilizador:} cada utilizador só pode aceder aos seus dados, e visualizar a informação que carregou.
    \item \textbf{Experiência de utilizador:} A plataforma tem de  ser capaz de oferecer uma boa experiência de utilização.
\end{itemize}

(Colocar as actual tabelas no apendice)


\subsection{Casos de Utilização}
(TODO)

- Colocar UML commo apendice
- Referenciar a matriz prioridade dos casos de utilização
Com os casos de utilização estabelecidos, foram identificados então os requisitos da plataforma, que podemos separar em requisitos funcionais e não funcionais

\textbf{ Falta a matriz de prioridade dos casos de utilização}

%%________________________________________________________________________
\section{Fundamentos}
\label{sec:fundamentos}

A aplicação desenvolvida segue a mesma organização que já existe na plataforma \textit{Marketplace Simulations}, por \textit{quarters}, em que cada \textit{quarter} corresponde a uma semana simulada, permitindo que cada utilizador possa carregar ficheiros Excel extraídos da plataforma . Esses ficheiros são tratados e depois transformados em CSV, e usados para criar visualizações. 

Significa que, estruturalmente, a aplicação depende de três entidades diferentes, que iremos descrever abaixo, e como se interligam no funcionamento da aplicação

\subsection{\textit{Quarters}}
Os \textit{quarters} funcionam como \textit{buckets} lógicos para organizar os ficheiros carregados pelos utilizadores. Cada utilizador pode criar múltiplos \textit{quarters}, identificados de forma única por um número. Este número serve tambem de identificador, sendo que não é possível ter dois \textit{quarters} identificados como 1 para cada utilizador.

A nível de implementação, cada \textit{quarter} está associado unicamente a um utilizador e é identificado por um UUID (gerado automaticamente pelo \textit{Django}), que garante que o \textit{quarter} seja único.

\subsection{Ficheiros}

Os ficheiros são inicialmente carregados no formato Excel, contendo uma ou várias folhas de cálculo. Cada folha é tratada como uma entidade individual e transformada para CSV. O ficheiro Excel é guardado como referência, mas não é diretamente utilizado para visualização.

Este processo de conversão para CSV é acompanhado por uma \textit{pipeline} de normalização de dados, que limpa os dados (como por exemplo, remover quebras de linha, colunas sem representação, nomes inconsistentes) e aplica regras para que os gráficos possam ser gerados de forma consistente. Cada ficheiro CSV gerado é associado ao seu ficheiro Excel de origem, ao \textit{quarter} correspondente, e o seu nome será baseado no nome da folha de onde foi extraído. Aos ficheiros CSV é também associado uma \textit{slug}, baseado também no nome, que identifica a informação que o CSV representa.

A plataforma garante que só existe uma versão ativa de cada ficheiro por tipo — caso o utilizador carregue novamente um ficheiro com o mesmo nome lógico, o anterior será marcado como não ativo, evitando duplicações e garantindo que os gráficos usam apenas dados mais recentes.

\subsection{Utilizadores}

A plataforma foi desenhada para funcionar com utilizadores, baseando-se no sistema de autenticação pré-existende do \textit{Django}. Cada utilizador tem a sua conta, e pode realizar operações como criação de \textit{quarters}, carregamento e alteração de ficheiros, e aceder aos gráficos gerados a partir desses ficheiros.

Cada utilizador tem acesso apenas aos seus próprios dados, garantindo o isolamento da informação. Esta separação é feita a nível da base de dados, através da associação de cada entidade ao utilizador que criou.

Apesar da plataforma não suportar explicitamente equipas ou grupos, assume-se que alunos do mesmo grupo podem carregar ficheiros semelhantes, mas o sistema trata-os como ficheiros diferentes. Assim, evita-se a complexidade adicional de gerir permissões ou partilha de dados entre contas. Também se assume que as contas podem ser criadas ao nível do grupo, pelo que para a plataforma, é indiferente se a conta é individual ou partilhada entre membros desse grupo.

No futuro, pode ser considerada a funcionalidade de desativação automática de contas (por exemplo, após o final do semestre), mas para já o modelo é simples e robusto: conta individual, dados isolados, e controlo completo sobre os próprios uploads.

%%________________________________________________________________________
\section{Abordagem}
\label{sec:abordagem}
%%________________________________________________________________________

Para a concretização do projeto, definimos então algumas abordagens que afetam a maneira como a plataforma é desenvolvida e utilizada. Apesar de o produto final ser uma aplicação \textit{web}, existem fatores diferenciadores neste projeto que só conseguem ser explicados em contexto com o problema que queremos resolver.
 
\subsection{Organização por \textit{Quarters}}

Uma das primeiras decisões que foram tomadas foi como organizar a informação recebida, e para facilitar a utilização da plataforma,  foi decidido organizar os dados por \textit{quarters}, refletindo o modelo temporal da simulação, onde as decisões são tomadas em em \textit{quarters}. Cada \textit{quarter} corresponde a uma semana, e a cada \textit{quarter} é possivel exportar um conjunto de ficheiros da plataforma original.  Assim conseguimos garantir que a interface visual é intuitiva e fácil de perceber, uma vez que o mapeamento dos \textit{quarters} é igual no modelo proposto. 

Esta organização é feita de forma intencional, pelos utilizadores da plataforma, ao criarem \textit{quarters} na plataforma, onde posteriormente carregam a informação. Os \textit{quarters} ajudam também a segmentar a informação carregada, e indica explicitamente à plataforma onde pertencem os dados.

 A alternativa seria inferir o \textit{quarter} através do nome do ficheiro (como por exemplo, \textit{CustomerNeeds-Q5.xlsx}, mas esta alternativa assumia que os alunos não trocam o nome ou não organizam os ficheiros de outra maneira e faria com que a plataforma dependesse de um identificador (nome do ficheiro) externo para determinar onde associar o ficheiro recebido.

\subsection{\textit{Pipeline} de Normalização de Dados}

Outro contributo diferenciador foi a criação de uma \textit{pipeline} modular de normalização de dados. O objetivo é garantir que os ficheiros Excel carregados, que muitas vezes contêm nomes de colunas inconsistentes, quebras de linha, espaços em excesso ou colunas irrelevantes, sejam convertidos em CSV com um formato adaptado para visualização. 

Como podemos receber muitos ficheiros, a variabilidade entre os dados recebidos é muito alta, pelo que alguns dados passam por mais do que uma fase de normalização. Esta decisão foi tomada com base numa análise manual, em que identificámos possíveis fontes de dados que precisam de mais do que uma fase de normalização. As várias fases de normalização alteram os dados de modo a facilitar a representação visual dos mesmos e é um passo essencial no projeto, porque garante que a aplicação trabalha com formatos e regras conhecidas, e remove a variabilidade dos ficheiros importados.

As fases de normalização irão ser descritas em mais detalhe nos capítulos seguintes, uma vez que a implementação destas pipeline estão relacionadas à tecnologia escolhida, mas o desenvolvimento desta \textit{pipeline} é um fator diferenciador deste projeto, uma vez que tem de lidar com dados que não estão estruturados de forma a facilitar representações visuais. 

Este processo de normalização é semelhante aos processos ETL (Extract, Transform, Load) ainda que neste projeto tenha sido desenvolvido com uma escala menor.

